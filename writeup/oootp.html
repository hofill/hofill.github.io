<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="/assets/css/normalize.css">
    <link rel="stylesheet" href="/assets/css/ockham.css">
    <script async src="/assets/js/ockham.js"></script>
    <script async src="https://use.fontawesome.com/releases/v5.15.4/js/all.js"></script>

    
<link rel="icon" href="/assets/img/cryptoicontfc.svg">
<title>oootp | hofill's blog</title>


</head>


<body>
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <img style="box-shadow: 0px 5px 10px 5px rgba(0,0,0,0.6)" alt="picture of me" src="/assets/img/noria22.png">
  </div>
  <div class="sidebar-item">
    <p>The place where <strike>magic</strike> hacking happens.</p>
  </div>

  
  <nav class="sidebar-nav">
    <ul class="sidebar-nav-list">
    
      <li">
        <a href="/" class="sidebar-nav-item ">
          Home
        </a>
      </li>
    
      <li">
        <a href="/about" class="sidebar-nav-item ">
          About
        </a>
      </li>
    
      <li">
        <a href="/writeups" class="sidebar-nav-item ">
          Writeups
        </a>
      </li>
    
      <li">
        <a href="/blogs" class="sidebar-nav-item ">
          Blogs
        </a>
      </li>
    
    </ul>
  </nav>
  

  
  <div class="sidebar-item">
    
      <a class="social-icon" href="https://github.com/hofill" target="_blank">
        <i class="fab fa-github" title="GitHub"></i>
      </a>
    
  </div>
  

  <div class="sidebar-item">
    <small>
      Powered by <a href="https://jekyllrb.com/" target="_blank">Jekyll</a> & <a href="https://github.com/zivong/ockham" target="_blank">Ockham</a>
    </small>
  </div>
</div>


<div class="wrap">
    <div class="container">

        <header class="masthead">
            <div class="masthead-title">
                <a href="/" title="Home"><span style="color: #06BCC1">hofill > ./blog</span></a>
                <small>Crypto enthusiast.</small>
            </div>
        </header>

        <main>
            <article class="post"><img alt="" src="https://unr22-individual.cyberedu.ro/images/contests/BMwo9sxqDZaYqNem.png" class="header-photo"><h1 class="post-title" style="color: #EF596F"><span class="helper">
        <img class="category-image" alt=""
                                                          src="/assets/img/categories/crypto.svg"></span><span
                class="title">oootp</span></h1>
    <div class="post-meta">
        <time datetime="2022-05-22T00:00:00+00:00" itemprop="datePublished">
            22 May 2022
        </time>•
        
        <span itemprop="author" itemscope itemtype="http://schema.org/Person">hofill</span></div>
    <div class="post-writeup-tags">
        
        <div class="type">
            crypto
        </div>
        
        <div class="type">
            OTP
        </div>
        
    </div>

    <h1 id="legend">Legend</h1>
<ul>
  <li><a href="#descr">Challenge Description</a></li>
  <li><a href="#flagproof">Flag Proof</a></li>
  <li><a href="#summary">Summary</a></li>
  <li><a href="#details">Details</a></li>
</ul>

<h1 id="descr">Challenge Description</h1>

<p>Bob encrypted his sensitive data with one time
pad, however we have the suspicion that he did something wrong. We
extracted some encrypted data. Note that Bob hates punctuation. Can you
decrypt the flag?</p>

<p><code class="language-plaintext highlighter-rouge">c192a8e9e01b95c69c14aae80368c668e97e1f234545beb02ab742c72d0a65043c1c8562d65cd7e462e391a8d50ba04e14d3ac4abe9f09fba4e9f05031b36055509d3bc2e59f18c709f87f</code></p>

<h1 id="flagproof">Flag Proof</h1>

<blockquote>
  <p>CTF{b20b26d59d0d4d2f66b69b1cbb5baa089ba8f4379ad24bc32a32fb063c8d16ab}</p>

</blockquote>

<h1 id="summary">Summary</h1>

<p>Run Many-Time Pad on the file and extract the key to use on the encrypted flag.</p>

<h1 id="descr">Details</h1>

<p>We have a hex string that has apparently been encrypted with <code class="language-plaintext highlighter-rouge">OTP</code>. Alongside that, we get a file called <code class="language-plaintext highlighter-rouge">encrypted_data.txt</code>, which contains a bunch of hex strings.</p>

<p>The title is a hint for the Many Time Pad vulnerability (OTP with many O’s). Basically, the user used the same password to encrypt both the flag and all of the hexstrings from the <code class="language-plaintext highlighter-rouge">encrypted_data.txt</code> file. For that, we can use a tool found on GitHub: <a href="https://github.com/CameronLonsdale/MTP">https://github.com/CameronLonsdale/MTP</a></p>

<p>Running the MTP script on our encrypted_data.txt file, we get the following:</p>

<p><img src="/assets/img/oootp/Untitled.png" alt="Untitled" /></p>

<p>The key at the bottom is the key used to decrypt our flag:</p>

<p><code class="language-plaintext highlighter-rouge">87fec98eda3bd692da6fc8da330af45e8d4b264775218ad418d174f14f3c5c660d7fe700e33eb68552dba8cab433c67a27e4952bdaad3d99c7dac2310281063760ab08a1ddfb29f1689a02</code></p>

<p>Using this, the given hexstring, and CyberChef, we can decrypt the flag and get:</p>

<blockquote>
  <p>Flag: CTF{b20b26d59d0d4d2f66b69b1cbb5baa089ba8f4379ad24bc32a32fb063c8d16ab}</p>

</blockquote>

<p><a href="https://gchq.github.io/CyberChef/#recipe=From_Hex('Auto')XOR(%7B'option':'Hex','string':'87fec98eda3bd692da6fc8da330af45e8d4b264775218ad418d174f14f3c5c660d7fe700e33eb68552dba8cab433c67a27e4952bdaad3d99c7dac2310281063760ab08a1ddfb29f1689a02'%7D,'Standard',false)&amp;input=YzE5MmE4ZTllMDFiOTVjNjljMTRhYWU4MDM2OGM2NjhlOTdlMWYyMzQ1NDViZWIwMmFiNzQyYzcyZDBhNjUwNDNjMWM4NTYyZDY1Y2Q3ZTQ2MmUzOTFhOGQ1MGJhMDRlMTRkM2FjNGFiZTlmMDlmYmE0ZTlmMDUwMzFiMzYwNTU1MDlkM2JjMmU1OWYxOGM3MDlmODdm">https://gchq.github.io/CyberChef/#recipe=From_Hex(‘Auto’)XOR({‘option’:’Hex’,’string’:’87fec98eda3bd692da6fc8da330af45e8d4b264775218ad418d174f14f3c5c660d7fe700e33eb68552dba8cab433c67a27e4952bdaad3d99c7dac2310281063760ab08a1ddfb29f1689a02’},’Standard’,false)&amp;input=YzE5MmE4ZTllMDFiOTVjNjljMTRhYWU4MDM2OGM2NjhlOTdlMWYyMzQ1NDViZWIwMmFiNzQyYzcyZDBhNjUwNDNjMWM4NTYyZDY1Y2Q3ZTQ2MmUzOTFhOGQ1MGJhMDRlMTRkM2FjNGFiZTlmMDlmYmE0ZTlmMDUwMzFiMzYwNTU1MDlkM2JjMmU1OWYxOGM3MDlmODdm</a></p>


</article>



<div class="post-pagination">
    
    <a class="post-pagination-item left" href="/writeup/dont-chat-rsa">
        <i class="fas fa-chevron-left"></i> <span class="post-pagination-title">Don’t chat too much about RSA!
</span>
    </a>
    

    
    <a class="post-pagination-item right" href="/writeup/shark-v2">
        <span class="post-pagination-title">shark-v2
</span> <i
            class="fas fa-chevron-right"></i>
    </a>
    
</div>

        </main>

        <footer class="footer">
            <small>
                &copy;
                <time datetime="2022-05-22T21:20:12+00:00">2022</time>&nbsp;<a href="https://github.com/hofill/" target="_blank">hofill</a>. All rights reserved.
            </small>
        </footer>
    </div>
</div>

<label for="sidebar-checkbox" class="sidebar-toggle"></label>




</body>
</html>
